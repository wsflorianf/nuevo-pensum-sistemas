---
//Se importa la información de todas las materias del pensum
import niveles from '@/data/infoMaterias'
import Materia from './Materia.astro'

// Arreglo dónde se guardarán la suma de los datos de las materias
let datosTotales: {
  tdTotal: number
  tcTotal: number
  taTotal: number
  creditosTotal: number
}[] = []

// Se itera cada nivel y se guardan en un objeto la suma de los datos todas las materias de ese nivel
niveles.forEach((nivel) => {
  let suma = nivel.materias.reduce(
    (datosTotales, materia) => {
      datosTotales.tdTotal += materia.td
      datosTotales.tcTotal += materia.tc
      datosTotales.taTotal += materia.ta
      datosTotales.creditosTotal += materia.creditos

      return datosTotales
    },
    { tdTotal: 0, tcTotal: 0, taTotal: 0, creditosTotal: 0 }
  )

  //Se anida al arreglo datosTotales la suma de los datos del nivel
  datosTotales.push(suma)
})
---

<div id='pensum'>
  {
    niveles.map((nivel, index) => {
      return (
        <>
          <h2>{nivel.nombre}</h2>

          <div class="materia">

          
          {nivel.materias.map((materia) => (
            <Materia {...materia} />
          ))}
          </div>

          <div class="total">
            <div>
              <p>TD: {datosTotales[index].tdTotal}</p>
              <p>TC: {datosTotales[index].tcTotal}</p>
              <p>TA: {datosTotales[index].taTotal}</p>
            </div>
            <p>Créditos: {datosTotales[index].creditosTotal}</p>
          </div>

        </>
      )
    })
  }
</div>

<style> 
  @media screen and (min-width: 800px) {
  

    #pensum {
      display: grid;
      grid-auto-flow: column;
      grid-template-rows: repeat(3, auto);    
      gap: 20px;  
    }

    
  }

  .materia{
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .total{
   text-align: center;
  }

  .total div{
    display: flex;
    gap: 10px;
  }

</style>
